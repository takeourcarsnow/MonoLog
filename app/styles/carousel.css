/* Carousel: horizontally scrollable set of images for posts with multiple images */
.card-media .carousel {
  display: flex; gap: 8px; overflow-x: auto; scroll-snap-type: x mandatory; -webkit-overflow-scrolling: touch;
}
.card-media .carousel img {
  flex: 0 0 100%; scroll-snap-align: center; width: 100%; height: auto; object-fit: contain; display: block;
}

/* Controlled transform-based carousel for posts (better UX than free horizontal scroll) */
.carousel-wrapper { position: relative; overflow: hidden; touch-action: auto; transition: height 320ms cubic-bezier(.2,.8,.2,1); }
.carousel-track {
  display: flex; transition: transform 320ms cubic-bezier(.2,.8,.2,1); width: 100%; will-change: transform;
}
.carousel-slide { flex: 0 0 100%; display: flex; align-items: center; justify-content: center; }
.carousel-slide .media-link { display: flex; align-items: center; justify-content: center; width: 100%; height: auto; }
.carousel-slide img { max-width: 100%; max-height: 100%; width: auto; height: auto; object-fit: contain; display: block; }

/* arrows */
.carousel-arrow {
  position: absolute; top: 50%; transform: translateY(-50%); z-index: 10;
  background: color-mix(in srgb, var(--bg), transparent 60%); border: 1px solid var(--border);
  width: 38px; height: 38px; border-radius: 999px; display: grid; place-items: center; cursor: pointer;
  box-shadow: 0 8px 18px rgba(0,0,0,0.08); color: var(--text); font-size: 22px; line-height: 1;
  opacity: 0; pointer-events: none; transition: opacity 180ms var(--transition-fast), transform 180ms var(--transition-fast);
}
.carousel-arrow.left { left: 8px; }
.carousel-arrow.right { right: 8px; }
.carousel-arrow:hover { transform: translateY(-50%) scale(1.03); }

/* Edge hover areas: reveal arrows when user is hovering near the left/right edges */
.carousel-wrapper { position: relative; }
.carousel-wrapper:focus { outline: none; }
.edge-area {
  position: absolute; top: 0; bottom: 0; width: 14%; z-index: 5; background: transparent;
  /* don't block clicks on slide content (Edit button) */
  pointer-events: none;
}
.edge-area.left { left: 0; }
.edge-area.right { right: 0; }

/* When hovering the left/right edge, reveal the corresponding arrow */
.edge-area.left:hover ~ .carousel-track + .carousel-arrow.left,
.carousel-wrapper:hover .edge-area.left:hover ~ .carousel-track + .carousel-arrow.left {
  opacity: 1; pointer-events: auto;
}
.edge-area.right:hover ~ .carousel-track + .carousel-arrow.right,
.carousel-wrapper:hover .edge-area.right:hover ~ .carousel-track + .carousel-arrow.right {
  opacity: 1; pointer-events: auto;
}

/* Also reveal arrows when wrapper is focused (keyboard users) or hovered overall */
.carousel-wrapper:focus .carousel-arrow,
.carousel-wrapper:hover .carousel-arrow {
  opacity: 0.9; pointer-events: auto;
}

/* dots */
.carousel-dots { position: absolute; left: 50%; transform: translateX(-50%); bottom: 8px; display: flex; gap: 8px; z-index: 11; }
.carousel-dots .dot {
  width: 8px; height: 8px; border-radius: 999px; background: color-mix(in srgb, var(--bg-elev), transparent 40%); border: 1px solid var(--border); padding: 0; cursor: pointer;
}
.carousel-dots .dot.active { background: var(--primary); border-color: transparent; box-shadow: 0 6px 18px rgba(0,0,0,0.12); transform: scale(1.15); }

/* make arrows and dots smaller on small screens */
@media (max-width: 640px) {
  .carousel-arrow { width: 34px; height: 34px; font-size: 20px; }
  .carousel-dots .dot { width: 7px; height: 7px; }
}

/* Carousel image sizing - unified for all screen sizes */
.card-media img,
.card-media .carousel img,
.carousel-slide img {
  max-height: 70vh;
  max-width: 100%;
  width: auto;
  object-fit: contain;
  display: block;
  margin: 0 auto;
}

/* Single-post view: force a stable carousel "canvas" so slides share the same
  height regardless of image aspect ratio. This avoids layout jumps when
  swiping and makes images scale to fit the visible area. Kept scoped to
  .post-view-wrap so feed/grid carousels continue to use natural sizing. */
.post-view-wrap .card-media {
  /* allow the media area to occupy a consistent portion of the viewport */
  max-height: 70vh; /* same cap as images above */
}
.post-view-wrap .carousel-wrapper,
.post-view-wrap .carousel-track,
.post-view-wrap .carousel-slide,
.post-view-wrap .card-media .media-link,
.post-view-wrap .card-media .monolog-image-zoom {
  height: 100%;
}
.post-view-wrap .carousel-wrapper {
  /* ensure wrapper matches the constrained parent height */
  height: 100%;
}
.post-view-wrap .carousel-slide { align-items: center; }

/* Ensure ImageZoom instances inside the single-post view behave as a
   contained canvas: make the inner <img> fill the container while
   preserving aspect ratio via object-fit: contain. This complements the
   inline styles applied by ImageZoom but gives a CSS fallback and keeps
   behavior consistent across browsers. */
.post-view-wrap .monolog-image-zoom img {
  width: 100% !important;
  height: 100% !important;
  max-width: none !important;
  object-fit: contain !important;
  object-position: center center !important;
}

/* keep carousel slides vertically centered when images are constrained */
.carousel-slide { align-items: center; justify-content: center; }

/* Make multipost containers smaller in feed/explore */
.feed .card.multipost .card-media img,
.feed .card.multipost .carousel-slide img {
  max-height: 60vh;
  height: auto;
  width: auto;
  object-fit: contain;
  display: block;
  border-radius: var(--radius);
}