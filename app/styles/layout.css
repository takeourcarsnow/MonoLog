.content {
  max-width: var(--maxw);
  margin: 0 auto;
  width: 100%;
  /* Make content scrollable within viewport */
  /* Use a fallback calculation for browsers that struggle with 100dvh */
  height: calc(var(--viewport-height, 1vh) * 100);
  /* Let content scroll on small screens; swiper will handle interactions when ready */
  overflow: hidden;
  -webkit-overflow-scrolling: touch;
  /* Reserve top space for fixed header and use consistent side padding */
  /* add a 1px buffer to bottom padding to avoid hairline gaps from rounding */
  padding: var(--header-height, calc(48px + var(--safe-top, 0px) + 12px + 8px)) var(--page-side-padding) calc(var(--tabbar-height, 64px) + 29px);
}
.upload-empty .content { padding-bottom: calc(28px + var(--safe-bottom)); }
*** End Patch

/* Strong page-level override when uploader has an active preview (JS toggles
  `body.uploader-has-preview`). This lives immediately after the base
  `.content` so it reliably overrides earlier padding. Adjust to taste. */
body.uploader-has-preview .content {
  padding-bottom: calc(28px + var(--safe-bottom)) !important;
}

/* Debug outline: add `document.body.classList.add('debug-uploader-outline')`
  in browser console to reveal outlines for the main containers while
  debugging the remaining vertical gap. Remove the class when done. */
body.debug-uploader-outline .content { outline: 3px dashed rgba(255,0,0,0.95); }
body.debug-uploader-outline .uploader { outline: 3px dashed rgba(0,200,0,0.95); }

/* Page slide: support swipe-to-navigate with smooth transforms. We keep
   a single .page-slide element and animate its transform/opacity on
   navigation or during pointer/touch drags. Respect prefers-reduced-motion
   by disabling translations for users who opt out. */
.content > .page-slide {
  position: relative;
  will-change: transform, opacity;
  transition: transform .26s var(--transition-mid), opacity .26s var(--transition-mid);
  transform: translateX(0);
}

/* directional classes used by JS navigation (enter/exit states) */
.content.slide-left > .page-slide { transform: translateX(-100%); opacity: 0.92; }
.content.slide-right > .page-slide { transform: translateX(100%); opacity: 0.92; }
.content.slide-enter-left > .page-slide { transform: translateX(100%); }
.content.slide-enter-right > .page-slide { transform: translateX(-100%); }

@media (prefers-reduced-motion: reduce) {
  .content > .page-slide { transition: opacity 120ms linear; transform: none !important; }
}

/* On desktop, allow content to scroll internally since body cannot scroll */
@media (min-width: 900px) {
  .content {
    height: auto;
    overflow: auto;
    /* Use the JS-driven --viewport-height so mobile browser chrome
       changes don't leave gaps. Fallback to 1vh if the variable isn't set. */
    min-height: calc((var(--viewport-height, 1vh) * 100) - var(--header-height, calc(48px + var(--safe-top, 0px) + 12px + 8px)) - var(--tabbar-height, 56px));
    padding-left: var(--page-side-padding);
    padding-right: var(--page-side-padding);
  }
}

/* Mobile-specific global adjustments */
@media (max-width: 768px) {
  .content {
    /* Use the JS-updated viewport height so the visible area is used
       (prevents gaps when mobile browser chrome collapses/expands). */
    height: calc(var(--viewport-height, 1vh) * 100);
    overflow: hidden;
    -webkit-overflow-scrolling: touch;
    padding-left: var(--page-side-padding-mobile);
    padding-right: var(--page-side-padding-mobile);
    padding-bottom: var(--about-bottom-gap, calc(var(--tabbar-height, 64px) + 28px));
  }
  /* Push the server-rendered about-card above the fixed tabbar on phones.
     Uses --about-bottom-gap set by the About page (falls back to --tabbar-height). */
  .about-card {
    margin-bottom: var(--about-bottom-gap, calc(var(--tabbar-height, 64px) + 24px));
  }
}